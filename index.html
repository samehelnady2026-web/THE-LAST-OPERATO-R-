<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BLOCKSAM PRO FINAL</title>
    <script src="https://cdn.jsdelivr.net/npm/appwrite@13.0.1"></script>
    <style>
        :root { --neon: #00f2ff; --bg: #0a0a0a; }
        body { margin: 0; overflow: hidden; background: var(--bg); font-family: sans-serif; color: white; text-align: center; }
        .overlay { position: fixed; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 6000; background: rgba(0,0,0,0.9); }
        .btn { width: 250px; padding: 15px; margin: 10px; border-radius: 15px; font-weight: bold; cursor: pointer; border: none; background: #ffd700; color: black; font-size: 18px; }
    </style>
</head>
<body>

    <div id="loading-screen" class="overlay">
        <h2 style="color:var(--neon)">BLOCKSAM CLOUD</h2>
        <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„...</p>
    </div>

    <div id="main-menu" class="overlay" style="display:none">
        <h1 style="color:var(--neon)">BLOCKSAM</h1>
        <button class="btn" onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨ ğŸ®</button>
        <div id="status-tag" style="font-size:10px; color:#555; margin-top:10px;">Cloud Ready</div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
    const { Client, Account, Databases, ID, Query } = Appwrite;
    const client = new Client()
        .setEndpoint('https://fra.cloud.appwrite.io/v1') // Ù…Ø·Ø§Ø¨Ù‚ Ù„ØµÙˆØ±Ùƒ
        .setProject('69943f560019334ae3b5');            // Ù…Ø·Ø§Ø¨Ù‚ Ù„ØµÙˆØ±Ùƒ

    const databases = new Databases(client);
    const account = new Account(client);
    const DB_ID = '69943bf8001373c3c286'; 
    const COL_ID = 'players';

    async function init() {
        // Ø´Ù„Ù†Ø§ Ø§Ù„Ù€ Alert Ø§Ù„Ø£Ø³ÙˆØ¯ Ø®Ø§Ù„Øµ Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠØ¶Ø§ÙŠÙ‚ÙƒØ´
        try {
            try { await account.createAnonymousSession(); } catch(e){}
            const user = await account.get();
            const res = await databases.listDocuments(DB_ID, COL_ID, [Query.equal('user_id', user.$id)]);
            
            if (res.documents.length === 0) {
                await databases.createDocument(DB_ID, COL_ID, ID.unique(), {
                    user_id: user.$id, coins: 0, cash: 0, current_skin: 'ğŸ¥·'
                });
            }
            showMenu();
        } catch (e) {
            console.log("Offline Mode Active");
            showMenu(); // Ù‡ÙŠØ¯Ø®Ù„Ùƒ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø­ØªÙ‰ Ù„Ùˆ Ù…ÙÙŠØ´ Ù†Øª
        }
    }

    function showMenu() {
        document.getElementById('loading-screen').style.display = 'none';
        document.getElementById('main-menu').style.display = 'flex';
    }

    function startGame() {
        document.getElementById('main-menu').style.display = 'none';
        alert("Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø¯Ø£Øª! Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† ÙˆØ§Ù„Ø³ÙŠØ±ÙØ± Ø´ØºØ§Ù„ âœ…");
    }

    init();
</script>
</body>
</html>
